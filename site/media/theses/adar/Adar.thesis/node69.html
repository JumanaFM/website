<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<!--Converted with LaTeX2HTML 96.1 (Feb 5, 1996) by Nikos Drakos (nikos@cbl.leeds.ac.uk), CBLU, University of Leeds -->
<HTML>
<HEAD>
<TITLE>The HsCache Service</TITLE>
<META NAME="description" CONTENT="The HsCache Service">
<META NAME="keywords" CONTENT="main">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<LINK REL=STYLESHEET HREF="main.css">
</HEAD>
<BODY LANG="EN">
 <A NAME="tex2html1056" HREF="node70.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="next_motif.gif"></A> <A NAME="tex2html1054" HREF="node57.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="up_motif.gif"></A> <A NAME="tex2html1048" HREF="node68.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="previous_motif.gif"></A> <A NAME="tex2html1058" HREF="node2.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="contents_motif.gif"></A>  <BR>
<B> Next:</B> <A NAME="tex2html1057" HREF="node70.html">Other Base Services</A>
<B>Up:</B> <A NAME="tex2html1055" HREF="node57.html">The Basic Services</A>
<B> Previous:</B> <A NAME="tex2html1049" HREF="node68.html">Future Improvements</A>
<BR> <P>
<H2><A NAME="SECTION001036000000000000000">The <tt>HsCache</tt> Service</A></H2>
<A NAME="HsCache">&#160;</A>
As discussed in Chapter&nbsp;<A HREF="node27.html#ch4HDM"><IMG  ALIGN=BOTTOM ALT="gif" SRC="cross_ref_motif.gif"></A>, the HDM at times makes
reference to external sources of information.  This allows the HDM to
remain compact in size, but still robust enough to handle the variety
of objects that a user may want to archive.
<P>
Recall that the <tt>Promise</tt> classes provide the mechanism for
``re-generating'' <tt>Needle</tt> data dynamically.  This is
inefficient, however, if the the same <tt>Promise</tt> is repeatedly
asked to generate the same data.  As a solution, Haystack provides a
mechanism for caching data created by a <tt>Promise</tt>.  Optionally,
a programmer may modify the <tt>getData()</tt> operation for a
<tt>Needle</tt> so that as data is being generated by the
<tt>Promise</tt> it is simulatenously being sent to disk for temporary
caching.  The <tt>Needle</tt> requests this disk space by calling the
<tt>allocateCache(key)</tt> command on the <tt>HsCache</tt>, where key
is the <tt>Needle</tt>'s ID.
<P>
When <tt>HsCache</tt> receives a request it returns a special
extension of the Java stream <tt>Writer</tt> class,
<tt>CacheFileWriter</tt>.  This extension overrides a number of the
<tt>Writer</tt>'s functions so that the <tt>HsCache</tt> can check to
see if the cache space is in use.
<P>
After the <tt>Needle</tt> has placed the data in the cache, it can
request that the <tt>HsCache</tt> open a <tt>Reader</tt> to that cache
space (a <tt>Promise</tt> holding <tt>Needle</tt> returns a
<tt>Reader</tt> when <tt>getData()</tt> is invoked).  This reader is
also an extension to the standarad <tt>Reader</tt> class and is called
<tt>CacheFileReader</tt>.  As data is read using the
<tt>CacheFileReader</tt> the ``life'' of the item in the cache is
extended.  As soon as data is not being actively read, the file will
be removed after a period of five to ten minutes.
<P>
<BR> <HR>
<P><ADDRESS>
Copyright 1998, Eytan Adar (eytan@alum.mit.edu)
</ADDRESS>
</BODY>
</HTML>
