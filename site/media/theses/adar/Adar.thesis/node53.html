<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<!--Converted with LaTeX2HTML 96.1 (Feb 5, 1996) by Nikos Drakos (nikos@cbl.leeds.ac.uk), CBLU, University of Leeds -->
<HTML>
<HEAD>
<TITLE>The HaystackRootServer</TITLE>
<META NAME="description" CONTENT="The HaystackRootServer">
<META NAME="keywords" CONTENT="main">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<LINK REL=STYLESHEET HREF="main.css">
</HEAD>
<BODY LANG="EN">
 <A NAME="tex2html870" HREF="node54.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="next_motif.gif"></A> <A NAME="tex2html868" HREF="node50.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="up_motif.gif"></A> <A NAME="tex2html862" HREF="node52.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="previous_motif.gif"></A> <A NAME="tex2html872" HREF="node2.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="contents_motif.gif"></A>  <BR>
<B> Next:</B> <A NAME="tex2html871" HREF="node54.html">The HsService Class</A>
<B>Up:</B> <A NAME="tex2html869" HREF="node50.html">The Haystack Service Model </A>
<B> Previous:</B> <A NAME="tex2html863" HREF="node52.html">Service Types</A>
<BR> <P>
<H1><A NAME="SECTION001020000000000000000">The <tt>HaystackRootServer</tt></A></H1>
<A NAME="HaystackRootServer">&#160;</A>
The Haystack system depends on the instantiation of the
<tt>HaystackRootServer</tt> object. This object performs much the same
functionality as the object request broker (ORB) does in CORBA.  We
decided against a CORBA model due to the complexity of the CORBA
architecture and the existence of very few, if any, full and public
domain implementations.  The <tt>HaystackRootServer</tt> object
automatically starts itself with a number of services.
<P>
The <tt>HaystackRootServer</tt> is instantiated in one of two modes,
root, and non-root. A user is always assumed to be running one
<tt>HaystackRootServer</tt> running in root mode. The server running
in root mode causes a number of event driven services and the HDM
objects to be loaded automatically into the VM's memory space. HDM
objects are currently loaded only into a root
<tt>HaystackRootServer</tt> as Haystack does not currently support a
concurrency model robust enough to allow for manipulation of HDM
structures outside of the main <tt>HaystackRootServer</tt>'s scope.
There are various pre-existing solutions that describe the
implementation of distributed object management that may be suitable
for intergration into Haystack in the future.
<P>
A non-root <tt>HaystackRootServer</tt> is used for the purposes of
loading services that need to run outside the root-VM. For example, if
a user has mutiple computers and wishes to archive the files on both
into one Haystack, they can run a non-root <tt>HaystackRootServer</tt>
with an archiver service on one machine and a
<tt>HaystackRootServer</tt> in root mode on the other.  All data then
gets aggregated from the non-root to the root
<tt>HaystackRootServer</tt> and the data from both machines is indexed
together.  For services that need to decide if they are running under
a root or non-root context, <tt>HaystackRootServer</tt> provides a
static method, <tt>amIRoot()</tt> to answer that question.
<P>
To successfully create a <tt>HaystackRootServer</tt>, a user must both
instantiate and initialize the <tt>HaystackRootServer</tt> object.
Instantiation is done through the standard <tt>new</tt> operator, and
initialization through the <tt>init()</tt> procedure of the
<tt>HaystackRootServer</tt>. It is important to note that the
<tt>HaystackRootServer</tt> utilizes a variant of the singleton
pattern[<A HREF="node88.html#gamma">18</A>] to insure that only one copy of the server is
running in a given VM.  The <tt>init()</tt> method takes a
configuration file, and an optional port as arguments. The port is
used for binding the <tt>Middleman</tt> service, and the configuration
file is routed to the <tt>HsConfigService</tt> for further processing.
Furthermore, the <tt>HaystackRootServer</tt> will invoke the
<tt>init()</tt> procedure on the <tt>HsNameService</tt> as well as the
<tt>HsConfigService</tt> (these are the two essential services we
need to bootstrap). Additionally, we can terminate the
<tt>HaystackRootServer</tt> by calling the <tt>close()</tt> method
which will close the <tt>HsNameService</tt>.
<P>
The only other vital function of the <tt>HaystackRootServer</tt> is
the ability to statically call for a number of the bootstrap services.
Table&nbsp;<A HREF="node53.html#tabRootServerStatic"><IMG  ALIGN=BOTTOM ALT="gif" SRC="cross_ref_motif.gif"></A> shows the static data member in the
<tt>HaystackRootServer</tt> and its corresponding value.
<P>
<P><A NAME="1957">&#160;</A><A NAME="tabRootServerStatic">&#160;</A> 
<center>    
<table border><tr><td>
<tr><td>Static variable </td><td>Points at </tr><tr><td>
<tr><td><tt>myNameService</tt> </td><td>The <tt>HsNameService</tt> running under this <tt>HaystackRootServer</tt>.  This allows us to lookup a pointer to any service. 
<tr><td><tt>myConfigService</tt> </td><td>The <tt>HsConfigService</tt>, holds global settings 
<tr><td><tt>myDebugger</tt> </td><td><tt>HsDebug</tt>, a tool for debugging Haystack 
<tr><td><tt>myErrLogger</tt> </td><td><tt>HsError</tt>, a tool to deal gracefully with errors 
<tr><td><tt>myPersistentStore</tt> </td><td>The <tt>HsPersistentObjectService</tt> 
<tr><td><tt>myObjCreator</tt> </td><td>The <tt>HsObjectCreatorService</tt> 
<tr><td><tt>myMsgLogger</tt> </td><td><tt>HsMessage</tt>, for non-error messages 
<tr><td><tt>myDispatcher</tt> </td><td>The <tt>HsDispatcher</tt>, so that new
    services can register their interest in HDM subgraphs. 
<tr><td><tt>myCounter</tt> </td><td>The <tt>HsCounter</tt> service generates unique IDs 
<tr><td><tt>mySendable</tt> </td><td>The appropriate <tt>Middleman</tt> object for this root server. </table><BR>
</CENTER></CENTER>
<STRONG>Table:</STRONG> Static variables within <tt>HaystackRootServer</tt><BR>
<P><BR> <HR>
<UL> 
<LI> <A NAME="tex2html873" HREF="node54.html#SECTION001021000000000000000">The <tt>HsService</tt> Class</A>
<LI> <A NAME="tex2html874" HREF="node55.html#SECTION001022000000000000000">The <tt>HsNameService</tt></A>
<UL> 
<LI> <A NAME="tex2html875" HREF="node56.html#SECTION001022100000000000000">Service Naming</A>
</UL>
</UL>
<HR><A NAME="tex2html870" HREF="node54.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="next_motif.gif"></A> <A NAME="tex2html868" HREF="node50.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="up_motif.gif"></A> <A NAME="tex2html862" HREF="node52.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="previous_motif.gif"></A> <A NAME="tex2html872" HREF="node2.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="contents_motif.gif"></A>  <BR>
<B> Next:</B> <A NAME="tex2html871" HREF="node54.html">The HsService Class</A>
<B>Up:</B> <A NAME="tex2html869" HREF="node50.html">The Haystack Service Model </A>
<B> Previous:</B> <A NAME="tex2html863" HREF="node52.html">Service Types</A>
<P><ADDRESS>
Copyright 1998, Eytan Adar (eytan@alum.mit.edu)
</ADDRESS>
</BODY>
</HTML>
